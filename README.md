# PPC
A Game Cube/Wii Power PC ASM to C/C++ Transcompiler/Static Recompiler.

# What Makes This Different From Decompiling?

Decompiling takes a ROM and splits it out into Assembly, then people convert it back into the C/C++ it was by hand or with tool assistance. The end goal being a byte for byte accurate ROM.

PPC also takes a ROM and converts it to Assembly (even using the same tools they do [DTK]()). But it then takes that Assembly and converts it into a AST tree. From there it emits C++ for each Assembly Instruction. The final output is a C++ codebase that can compile to a native binary on any platform.

The finer details are more complicated and there are write ups for the entire [Toolchain Pipeline](). But this method is not a replacement for decompiling. But instead another method of understanding the game, and even assist in decompling. As some of the tools made for static recomp can be used in a normal decompilation, along with code structure.

# Toolchain

The Toolchain depends on a disassembly generated by [DTK](). The symbols are then parsed into a PPC Map by the [Symbol Cruncher](). This generates a custom Map format used by the rest of the toolchain for struct and function symbols. Optiontionally it can rename a bunch of object symbols based on their type to make it easier to read and decompile.

The DTK Assembly is then passed into the Lexer along with the PPC Map. This generates Token Streams. Various subpasses can be added to this operation. Mainly if you don't intend to use PPC for a decomp. But it removes excess data and cleans up the Token Streams for later tools. Reducing the amount of parsing needed to be done.

Theses Token Streams are then passed into the IREmiter. This generates a AST and compresses a bunch of the Tokens into Nodes. From here, memory offsets are resolved to the best of it's ability.

Finally the AST is passed into the CGen to generate C++/C code that compiles with the [PPC Runtime](). This Runtime and outputed C++ code can then be compiled to a binary. This outputed code might need to be cleaned up as some operations can be handled generally.

# How To Use?

This is not done yet, as every tool hasen't been finalized.

- Step 1: Grab the latest [release]() and zip it. Then grab a Game Cube ROM you wish to decompile.

- Step 2: in a command prompt run `python Stage0_Disassemble.py "pathToTheROM" "outputDirectory"`

- Step 3: run `SymbolCruncher.exe -symbols "path to the DTK Symbol File" -out "path to the output directory for the PPC Map"`

- Step 4 run `PPCLexer.exe -asmDir "directory of all the ASM DTK generated is" -map "path to the PPC Map" -out "directory where the outputed Token Streams should go" -mode Recomp`

- Step 5 run `PPCIR.exe -tokenDir "directory where all the Token Streams where generated" -out "file path to where the huge AST file should go"`

- Step 5 run `CGen.exe -AST "file path to the AST file" -out "where the C++ project should be generated" -name "name of the C++ project" -runtime "path to your chosen runtime source"`